\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{base}[2022/02/19 base]

\newif\ifbase@print
\base@printfalse
\DeclareOption{print}{\base@printtrue}
\ProcessOptions\relax

\RequirePackage{xcolor,graphicx}
\RequirePackage[math-style=ISO,warnings-off={mathtools-colon}]{unicode-math}
\RequirePackage[no-math,match,deluxe,sourcehan-jp,jfm_yoko=jlreq]{luatexja-preset}
\RequirePackage{mathtools,amsthm,thmtools}
\RequirePackage[ISO]{diffcoeff}
\RequirePackage[unicode,pdfusetitle]{hyperref}
\RequirePackage{cleveref}
\RequirePackage{makeidx}
\RequirePackage{tcolorbox}
\tcbuselibrary{breakable,skins,theorems}

% フォント
\setmainfont{STIX Two Text}
\setsansfont{Liberation Sans}
\setmathfont{STIX Two Math}

% 参照
\hypersetup{colorlinks=true,allcolors=blue}
\ifbase@print\hypersetup{draft=true}\fi
\crefname{chapter}{第}{第}
\crefname{section}{第}{第}
\crefname{subsection}{第}{第}
\crefname{table}{表}{表}
\crefname{figure}{図}{図}
\crefname{equation}{式}{式}
\crefname{example}{例}{例}
\crefname{definition}{定義}{定義}
\crefname{theorem}{定理}{定理}
\crefname{proposition}{命題}{命題}
\crefname{lemma}{補題}{補題}
\crefname{exercise}{例題}{例題}
\creflabelformat{chapter}{#2#1#3章}
\creflabelformat{section}{#2#1#3節}
\creflabelformat{subsection}{#2#1#3小節}

% セマンティクス
\newcommand{\impact}[1]{{\gtfamily\bfseries #1}}

\newlength{\base@parindent}
\newenvironment{lead}%
  {\hfill\setlength{\base@parindent}{\parindent}\begin{minipage}{\textwidth-4\zw}\setlength{\parindent}{\base@parindent}}%
  {\end{minipage}\vspace{2\zh}}

% 定理環境
\tcbset{%
  mytheorem/.style={%
    enhanced,breakable,
    theorem style=plain,label type={#1},
    fonttitle=\sffamily\bfseries,
    description delimiters={\inhibitglue（}{）\hspace{-0.5\zw}},
    terminator sign={\hspace{1\zw}},
    colframe=black,colback=white,colbacktitle=white,coltitle=black,
    top=1.5mm,right=1.5mm,bottom=1.5mm,left=1.5mm,
    arc=0mm,boxrule=0.4pt}}

\newcounter{thcounter}
\numberwithin{thcounter}{chapter}
\declaretheoremstyle[headfont=\sffamily\bfseries,headpunct={},postheadspace=1\zw,qed=\diamondsuit]{egstyle}
\declaretheorem[sibling=thcounter,style=egstyle,name=例]{example}
\newtcbtheorem[use counter=thcounter]{definition}{定義}{mytheorem=definition}{definition}
\newtcbtheorem[use counter=thcounter]{theorem}{定理}{mytheorem=theorem}{theorem}
\newtcbtheorem[use counter=thcounter]{proposition}{命題}{mytheorem=proposition}{proposition}
\newtcbtheorem[use counter=thcounter]{lemma}{補題}{mytheorem=lemma}{lemma}
\newtcbtheorem[use counter=thcounter]{exercise}{例題}{mytheorem=exercise}{exercise}

% 索引
\newcommand{\idxdelim}{\hfill}
\newcommand{\makeidxhead}[1]{{\vbox{\hbox to \linewidth{\hfill\sffamily\bfseries #1\hfill}}}\nopagebreak}
\newcommand{\symbolindexname}{記号}
